2025-08-29 07:22:01,444 - rate_limiter - INFO - Deployment detection: {'REPLIT_DEPLOYMENT': None, 'REPL_DEPLOYMENT': None, 'fantacalcioai.it': False, 'ENVIRONMENT': None, 'HOSTNAME': False, 'replit.dev': False, 'repl.co': False, 'deployment_file': False} -> False
2025-08-29 07:22:01,444 - rate_limiter - INFO - RateLimiter initialized: max_requests=10, window=3600s, deployed=False
2025-08-29 07:22:01,452 - web_interface - INFO - Starting Fantasy Football Assistant Web Interface
2025-08-29 07:22:01,452 - web_interface - INFO - Server: 0.0.0.0:5000
2025-08-29 07:22:01,452 - web_interface - INFO - App should be accessible at the preview URL
 * Serving Flask app 'web_interface'
 * Debug mode: off
2025-08-29 07:22:01,457 - werkzeug - INFO - WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://172.31.88.2:5000
2025-08-29 07:22:01,458 - werkzeug - INFO - Press CTRL+C to quit
2025-08-29 07:22:01,902 - web_interface - INFO - Request: GET / from 172.31.88.2
2025-08-29 07:22:01,902 - web_interface - INFO - Page view: 1bfefee6512d46b2, lang: it
2025-08-29 07:22:01,921 - werkzeug - INFO - 172.31.88.2 - - [29/Aug/2025 07:22:01] "GET / HTTP/1.1" 200 -
2025-08-29 07:22:02,871 - werkzeug - INFO - 172.31.88.2 - - [29/Aug/2025 07:22:02] "GET /api/rate-limit-status HTTP/1.1" 200 -
2025-08-29 07:22:04,354 - web_interface - INFO - Chat request from client: dev_environment
2025-08-29 07:22:04,355 - web_interface - INFO - Request data: {'message': 'Migliori attaccanti per budget 150 crediti?', 'mode': 'classic'}
2025-08-29 07:22:04,355 - web_interface - INFO - [ETL] Job di refresh lanciato
2025-08-29 07:22:04,355 - web_interface - INFO - Initializing FantacalcioAssistant (singleton)...
2025-08-29 07:22:04,355 - fantacalcio_assistant - INFO - Initializing FantacalcioAssistant...
2025-08-29 07:22:04,355 - fantacalcio_assistant - INFO - [Assistant] ENABLE_WEB_FALLBACK raw='0' parsed=False
2025-08-29 07:22:04,355 - fantacalcio_assistant - INFO - [Assistant] ROSTER_JSON_PATH=./season_roster.json
2025-08-29 07:22:04,355 - fantacalcio_assistant - INFO - [Assistant] EXTERNAL_YOUTH_CACHE=./cache/under21_cache.json
2025-08-29 07:22:04,356 - fantacalcio_assistant - INFO - [Assistant] OpenAI model=gpt-4o-mini temp=0.20 max_tokens=600
2025-08-29 07:22:04,362 - fantacalcio_assistant - INFO - [Assistant] prompt.json caricato correttamente
2025-08-29 07:22:04,362 - knowledge_manager - INFO - [KM] Initializing KnowledgeManager...
2025-08-29 07:22:04,386 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-29 07:22:04,570 - knowledge_manager - INFO - [KM] Using Chroma PersistentClient at ./chroma_db
2025-08-29 07:22:04,603 - knowledge_manager - INFO - [KM] Collection caricata: 'fantacalcio_knowledge', count=893
2025-08-29 07:22:04,604 - knowledge_manager - INFO - ðŸ”„ Initializing SentenceTransformer (attempt 1/10)...
2025-08-29 07:22:04,604 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-29 07:22:06,344 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-08-29 07:22:06,346 - knowledge_manager - INFO - âœ… SentenceTransformer initialized successfully on attempt 1
2025-08-29 07:22:06,346 - fantacalcio_assistant - INFO - [Assistant] KnowledgeManager attivo
2025-08-29 07:22:06,440 - fantacalcio_assistant - INFO - [Assistant] CorrectionsManager inizializzato
2025-08-29 07:22:06,832 - fantacalcio_assistant - INFO - [Assistant] Roster normalizzato: 638/638 record utili
2025-08-29 07:22:06,833 - fantacalcio_assistant - INFO - [Assistant] Loaded 0 players from external youth cache.
2025-08-29 07:22:06,833 - fantacalcio_assistant - INFO - [Assistant] age_index caricato: 185 chiavi
2025-08-29 07:22:06,834 - fantacalcio_assistant - INFO - [Assistant] overrides caricato: 186 chiavi
2025-08-29 07:22:06,834 - fantacalcio_assistant - INFO - [Assistant] override roles caricati: 186
2025-08-29 07:22:06,842 - fantacalcio_assistant - INFO - [Assistant] Applied data corrections to roster: 638 players, 0 excluded
2025-08-29 07:22:07,023 - fantacalcio_assistant - INFO - [Assistant] SEASON_FILTER auto: 2025-26
2025-08-29 07:22:07,071 - fantacalcio_assistant - INFO - [Assistant] EtÃ  arricchite su 71 record
2025-08-29 07:22:08,468 - fantacalcio_assistant - INFO - [Assistant] Pool filtrato: 638 record principali + 98 synthetic U21, stagione=2025-26
2025-08-29 07:22:08,468 - fantacalcio_assistant - INFO - [Assistant] Inizializzazione completata
2025-08-29 07:22:08,468 - web_interface - INFO - FantacalcioAssistant initialized successfully
Batches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  1.64it/s]
2025-08-29 07:22:09,125 - web_interface - INFO - Applying exclusions: session=[], persistent=[]
2025-08-29 07:22:09,136 - werkzeug - INFO - 172.31.88.2 - - [29/Aug/2025 07:22:09] "POST /api/chat HTTP/1.1" 200 -
2025-08-29 07:22:14,146 - web_interface - INFO - Chat request from client: dev_environment
2025-08-29 07:22:14,147 - web_interface - INFO - Request data: {'message': 'Top centrocampisti (budget 120)', 'mode': 'classic'}
2025-08-29 07:22:14,147 - web_interface - INFO - [ETL] Job di refresh lanciato
2025-08-29 07:22:14,147 - web_interface - INFO - Initializing FantacalcioAssistant (singleton)...
2025-08-29 07:22:14,147 - fantacalcio_assistant - INFO - Initializing FantacalcioAssistant...
2025-08-29 07:22:14,147 - fantacalcio_assistant - INFO - [Assistant] ENABLE_WEB_FALLBACK raw='0' parsed=False
2025-08-29 07:22:14,148 - fantacalcio_assistant - INFO - [Assistant] ROSTER_JSON_PATH=./season_roster.json
2025-08-29 07:22:14,148 - fantacalcio_assistant - INFO - [Assistant] EXTERNAL_YOUTH_CACHE=./cache/under21_cache.json
2025-08-29 07:22:14,148 - fantacalcio_assistant - INFO - [Assistant] OpenAI model=gpt-4o-mini temp=0.20 max_tokens=600
2025-08-29 07:22:14,148 - fantacalcio_assistant - INFO - [Assistant] prompt.json caricato correttamente
2025-08-29 07:22:14,148 - knowledge_manager - INFO - [KM] Initializing KnowledgeManager...
2025-08-29 07:22:14,151 - knowledge_manager - INFO - [KM] Using Chroma PersistentClient at ./chroma_db
2025-08-29 07:22:14,152 - knowledge_manager - INFO - [KM] Collection caricata: 'fantacalcio_knowledge', count=893
2025-08-29 07:22:14,152 - knowledge_manager - INFO - ðŸ”„ Initializing SentenceTransformer (attempt 1/10)...
2025-08-29 07:22:14,153 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-29 07:22:14,789 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-08-29 07:22:14,790 - knowledge_manager - INFO - âœ… SentenceTransformer initialized successfully on attempt 1
2025-08-29 07:22:14,791 - fantacalcio_assistant - INFO - [Assistant] KnowledgeManager attivo
2025-08-29 07:22:14,862 - fantacalcio_assistant - INFO - [Assistant] CorrectionsManager inizializzato
2025-08-29 07:22:15,299 - fantacalcio_assistant - INFO - [Assistant] Roster normalizzato: 638/638 record utili
2025-08-29 07:22:15,299 - fantacalcio_assistant - INFO - [Assistant] Loaded 0 players from external youth cache.
2025-08-29 07:22:15,300 - fantacalcio_assistant - INFO - [Assistant] age_index caricato: 185 chiavi
2025-08-29 07:22:15,300 - fantacalcio_assistant - INFO - [Assistant] overrides caricato: 186 chiavi
2025-08-29 07:22:15,300 - fantacalcio_assistant - INFO - [Assistant] override roles caricati: 186
2025-08-29 07:22:15,305 - fantacalcio_assistant - INFO - [Assistant] Applied data corrections to roster: 638 players, 0 excluded
2025-08-29 07:22:15,481 - fantacalcio_assistant - INFO - [Assistant] SEASON_FILTER auto: 2025-26
2025-08-29 07:22:15,531 - fantacalcio_assistant - INFO - [Assistant] EtÃ  arricchite su 71 record
2025-08-29 07:22:16,843 - web_interface - INFO - Chat request from client: dev_environment
2025-08-29 07:22:16,843 - web_interface - INFO - Request data: {'message': 'Top difensori (budget 100)', 'mode': 'classic'}
2025-08-29 07:22:16,849 - web_interface - INFO - [ETL] Job di refresh lanciato
2025-08-29 07:22:16,854 - web_interface - INFO - Initializing FantacalcioAssistant (singleton)...
2025-08-29 07:22:16,859 - fantacalcio_assistant - INFO - Initializing FantacalcioAssistant...
2025-08-29 07:22:16,859 - fantacalcio_assistant - INFO - [Assistant] ENABLE_WEB_FALLBACK raw='0' parsed=False
2025-08-29 07:22:16,859 - fantacalcio_assistant - INFO - [Assistant] ROSTER_JSON_PATH=./season_roster.json
2025-08-29 07:22:16,865 - fantacalcio_assistant - INFO - [Assistant] EXTERNAL_YOUTH_CACHE=./cache/under21_cache.json
2025-08-29 07:22:16,871 - fantacalcio_assistant - INFO - [Assistant] OpenAI model=gpt-4o-mini temp=0.20 max_tokens=600
2025-08-29 07:22:16,871 - fantacalcio_assistant - INFO - [Assistant] prompt.json caricato correttamente
2025-08-29 07:22:16,871 - knowledge_manager - INFO - [KM] Initializing KnowledgeManager...
2025-08-29 07:22:16,874 - knowledge_manager - INFO - [KM] Using Chroma PersistentClient at ./chroma_db
2025-08-29 07:22:16,876 - knowledge_manager - INFO - [KM] Collection caricata: 'fantacalcio_knowledge', count=893
2025-08-29 07:22:16,886 - knowledge_manager - INFO - ðŸ”„ Initializing SentenceTransformer (attempt 1/10)...
2025-08-29 07:22:16,892 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-29 07:22:16,897 - fantacalcio_assistant - INFO - [Assistant] Pool filtrato: 638 record principali + 98 synthetic U21, stagione=2025-26
2025-08-29 07:22:16,899 - fantacalcio_assistant - INFO - [Assistant] Inizializzazione completata
2025-08-29 07:22:16,899 - web_interface - INFO - FantacalcioAssistant initialized successfully
Batches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  3.45it/s]
2025-08-29 07:22:17,934 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-08-29 07:22:17,936 - knowledge_manager - INFO - âœ… SentenceTransformer initialized successfully on attempt 1
2025-08-29 07:22:17,936 - fantacalcio_assistant - INFO - [Assistant] KnowledgeManager attivo
2025-08-29 07:22:17,972 - fantacalcio_assistant - INFO - [Assistant] CorrectionsManager inizializzato
2025-08-29 07:22:18,477 - fantacalcio_assistant - INFO - [Assistant] Roster normalizzato: 638/638 record utili
2025-08-29 07:22:18,478 - fantacalcio_assistant - INFO - [Assistant] Loaded 0 players from external youth cache.
2025-08-29 07:22:18,478 - fantacalcio_assistant - INFO - [Assistant] age_index caricato: 185 chiavi
2025-08-29 07:22:18,479 - fantacalcio_assistant - INFO - [Assistant] overrides caricato: 186 chiavi
2025-08-29 07:22:18,479 - fantacalcio_assistant - INFO - [Assistant] override roles caricati: 186
2025-08-29 07:22:18,483 - fantacalcio_assistant - INFO - [Assistant] Applied data corrections to roster: 638 players, 0 excluded
2025-08-29 07:22:18,667 - fantacalcio_assistant - INFO - [Assistant] SEASON_FILTER auto: 2025-26
2025-08-29 07:22:18,714 - fantacalcio_assistant - INFO - [Assistant] EtÃ  arricchite su 71 record
2025-08-29 07:22:18,968 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-29 07:22:19,067 - web_interface - INFO - Applying exclusions: session=[], persistent=[]
2025-08-29 07:22:19,162 - werkzeug - INFO - 172.31.88.2 - - [29/Aug/2025 07:22:19] "POST /api/chat HTTP/1.1" 200 -
2025-08-29 07:22:20,379 - fantacalcio_assistant - INFO - [Assistant] Pool filtrato: 638 record principali + 98 synthetic U21, stagione=2025-26
2025-08-29 07:22:20,379 - fantacalcio_assistant - INFO - [Assistant] Inizializzazione completata
2025-08-29 07:22:20,380 - web_interface - INFO - FantacalcioAssistant initialized successfully
Batches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 10.68it/s]
2025-08-29 07:22:21,209 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-29 07:22:21,220 - web_interface - INFO - Applying exclusions: session=[], persistent=[]
2025-08-29 07:22:21,228 - werkzeug - INFO - 172.31.88.2 - - [29/Aug/2025 07:22:21] "POST /api/chat HTTP/1.1" 200 -